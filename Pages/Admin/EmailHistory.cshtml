@page
@model EmailHistoryModel

<style>
    footer, .footer {
        display: none !important;
    }


    nav, .navbar, .header, header {
        display: none !important;
    }
    .toggle-section {
        display: none;
    }

        .toggle-section.show {
            display: block;
        }
</style>
<div class="flex justify-between items-center mb-6">
    <a href="/Admin/AdminDashboard" class="btn btn-secondary">← Back to Dashboard</a>

    <h1 class="text-xl font-semibold text-gray-800">Email History</h1>
</div>
<div class="p-6">
    

    @if (Model.GroupedLogsByDate?.Any() == true)
    {
        foreach (var group in Model.GroupedLogsByDate)
        {
            var dateId = $"day_{group.Key:yyyyMMdd}";

            <div class="mb-4 border border-gray-300 rounded">
                <button class="w-full text-left px-4 py-2 bg-blue-100 hover:bg-blue-200 font-semibold"
                        onclick="toggleDetail('@dateId')">
                     @group.Key.ToString("dd/MM/yyyy")
                </button>

                <div id="@dateId" class="toggle-section px-4 py-3 bg-white border-t border-gray-300">
                    <table class="w-full text-sm border border-gray-300">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="border px-3 py-2 text-left">#</th>
                                <th class="border px-3 py-2 text-left">Recipient Email</th>
                                <th class="border px-3 py-2 text-left">Subject</th>
                                <th class="border px-3 py-2 text-left">Send At</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int count = 1;
                                foreach (var log in group.Value)
                                {
                                    <tr>
                                        <td class="border px-3 py-1">@count</td>
                                        <td class="border px-3 py-1">@log.RecipientEmail</td>
                                        <td class="border px-3 py-1">@log.Subject</td>
                                        <td class="border px-3 py-1">@log.SentAt.ToString("HH:mm:ss")</td>
                                    </tr>
                                    count++;
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }
    }
    else
    {
        <p class="text-gray-500">No email data.</p>
    }
</div>

@section Scripts {
    <script>
        function toggleDetail(id) {
            const section = document.getElementById(id);
            section.classList.toggle("show");
        }
    </script>
}
